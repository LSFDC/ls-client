; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.30319.01 

	TITLE	D:\Lost Saga For Developer\Youtube\Tutorial\Source\src\LSClient\ioClientUDPSocket.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	??_7ioClientUDPSocket@@6B@			; ioClientUDPSocket::`vftable'
PUBLIC	??1ioClientUDPSocket@@UAE@XZ			; ioClientUDPSocket::~ioClientUDPSocket
PUBLIC	??_R4ioClientUDPSocket@@6B@			; ioClientUDPSocket::`RTTI Complete Object Locator'
PUBLIC	??_R0?AVioClientUDPSocket@@@8			; ioClientUDPSocket `RTTI Type Descriptor'
PUBLIC	??_R3ioClientUDPSocket@@8			; ioClientUDPSocket::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2ioClientUDPSocket@@8			; ioClientUDPSocket::`RTTI Base Class Array'
PUBLIC	??_R1A@?0A@EA@ioClientUDPSocket@@8		; ioClientUDPSocket::`RTTI Base Class Descriptor at (0,-1,0,64)'
PUBLIC	??_R1A@?0A@EA@ioUDPSocket@@8			; ioUDPSocket::`RTTI Base Class Descriptor at (0,-1,0,64)'
PUBLIC	??_R0?AVioUDPSocket@@@8				; ioUDPSocket `RTTI Type Descriptor'
PUBLIC	??_R3ioUDPSocket@@8				; ioUDPSocket::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2ioUDPSocket@@8				; ioUDPSocket::`RTTI Base Class Array'
PUBLIC	?ProcessPacket@ioClientUDPSocket@@UAEXAAVCPacket@@PADH@Z ; ioClientUDPSocket::ProcessPacket
PUBLIC	?RcvPeerInfo@ioClientUDPSocket@@UAEXPADH@Z	; ioClientUDPSocket::RcvPeerInfo
PUBLIC	?CheckNS@ioClientUDPSocket@@UAE_NAAVCPacket@@@Z	; ioClientUDPSocket::CheckNS
EXTRN	__imp_??1ioUDPSocket@@UAE@XZ:PROC
EXTRN	___CxxFrameHandler3:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	__EH_epilog3:PROC
EXTRN	__EH_prolog3:PROC
EXTRN	??_7type_info@@6B@:QWORD			; type_info::`vftable'
EXTRN	?SocketErrorMsg@ioUDPSocket@@UAEXPBD@Z:PROC	; ioUDPSocket::SocketErrorMsg
EXTRN	??_EioClientUDPSocket@@UAEPAXI@Z:PROC		; ioClientUDPSocket::`vector deleting destructor'
;	COMDAT ??_R2ioUDPSocket@@8
; File d:\lost saga for developer\youtube\tutorial\source\src\lsclient\ioclientudpsocket.cpp
rdata$r	SEGMENT
??_R2ioUDPSocket@@8 DD FLAT:??_R1A@?0A@EA@ioUDPSocket@@8 ; ioUDPSocket::`RTTI Base Class Array'
rdata$r	ENDS
;	COMDAT ??_R3ioUDPSocket@@8
rdata$r	SEGMENT
??_R3ioUDPSocket@@8 DD 00H				; ioUDPSocket::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	01H
	DD	FLAT:??_R2ioUDPSocket@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVioUDPSocket@@@8
_DATA	SEGMENT
??_R0?AVioUDPSocket@@@8 DD FLAT:??_7type_info@@6B@	; ioUDPSocket `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVioUDPSocket@@', 00H
_DATA	ENDS
;	COMDAT ??_R1A@?0A@EA@ioUDPSocket@@8
rdata$r	SEGMENT
??_R1A@?0A@EA@ioUDPSocket@@8 DD FLAT:??_R0?AVioUDPSocket@@@8 ; ioUDPSocket::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	00H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3ioUDPSocket@@8
rdata$r	ENDS
;	COMDAT ??_R1A@?0A@EA@ioClientUDPSocket@@8
rdata$r	SEGMENT
??_R1A@?0A@EA@ioClientUDPSocket@@8 DD FLAT:??_R0?AVioClientUDPSocket@@@8 ; ioClientUDPSocket::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	01H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3ioClientUDPSocket@@8
rdata$r	ENDS
;	COMDAT ??_R2ioClientUDPSocket@@8
rdata$r	SEGMENT
??_R2ioClientUDPSocket@@8 DD FLAT:??_R1A@?0A@EA@ioClientUDPSocket@@8 ; ioClientUDPSocket::`RTTI Base Class Array'
	DD	FLAT:??_R1A@?0A@EA@ioUDPSocket@@8
rdata$r	ENDS
;	COMDAT ??_R3ioClientUDPSocket@@8
rdata$r	SEGMENT
??_R3ioClientUDPSocket@@8 DD 00H			; ioClientUDPSocket::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	02H
	DD	FLAT:??_R2ioClientUDPSocket@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVioClientUDPSocket@@@8
_DATA	SEGMENT
??_R0?AVioClientUDPSocket@@@8 DD FLAT:??_7type_info@@6B@ ; ioClientUDPSocket `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVioClientUDPSocket@@', 00H
_DATA	ENDS
;	COMDAT ??_R4ioClientUDPSocket@@6B@
rdata$r	SEGMENT
??_R4ioClientUDPSocket@@6B@ DD 00H			; ioClientUDPSocket::`RTTI Complete Object Locator'
	DD	00H
	DD	00H
	DD	FLAT:??_R0?AVioClientUDPSocket@@@8
	DD	FLAT:??_R3ioClientUDPSocket@@8
rdata$r	ENDS
;	COMDAT ??_7ioClientUDPSocket@@6B@
CONST	SEGMENT
??_7ioClientUDPSocket@@6B@ DD FLAT:??_R4ioClientUDPSocket@@6B@ ; ioClientUDPSocket::`vftable'
	DD	FLAT:?ProcessPacket@ioClientUDPSocket@@UAEXAAVCPacket@@PADH@Z
	DD	FLAT:?RcvPeerInfo@ioClientUDPSocket@@UAEXPADH@Z
	DD	FLAT:?SocketErrorMsg@ioUDPSocket@@UAEXPBD@Z
	DD	FLAT:?CheckNS@ioClientUDPSocket@@UAE_NAAVCPacket@@@Z
	DD	FLAT:??_EioClientUDPSocket@@UAEPAXI@Z
CONST	ENDS
;	COMDAT xdata$x
xdata$x	SEGMENT
__unwindtable$??1ioClientUDPSocket@@UAE@XZ DD 0ffffffffH
	DD	FLAT:__unwindfunclet$??1ioClientUDPSocket@@UAE@XZ$0
__ehfuncinfo$??1ioClientUDPSocket@@UAE@XZ DD 019930522H
	DD	01H
	DD	FLAT:__unwindtable$??1ioClientUDPSocket@@UAE@XZ
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
; Function compile flags: /Ogsp
xdata$x	ENDS
;	COMDAT ??1ioClientUDPSocket@@UAE@XZ
_TEXT	SEGMENT
_this$ = -16						; size = 4
__$EHRec$ = -12						; size = 12
??1ioClientUDPSocket@@UAE@XZ PROC			; ioClientUDPSocket::~ioClientUDPSocket, COMDAT
; _this$ = ecx

; 17   : {

  00000	6a 04		 push	 4
  00002	b8 00 00 00 00	 mov	 eax, __ehhandler$??1ioClientUDPSocket@@UAE@XZ
  00007	e8 00 00 00 00	 call	 __EH_prolog3
  0000c	8b f9		 mov	 edi, ecx
  0000e	89 7d f0	 mov	 DWORD PTR _this$[ebp], edi
  00011	c7 07 00 00 00
	00		 mov	 DWORD PTR [edi], OFFSET ??_7ioClientUDPSocket@@6B@

; 18   : 	SAFEDELETE( m_pNS );

  00017	8b 8f 40 81 00
	00		 mov	 ecx, DWORD PTR [edi+33088]
  0001d	83 65 fc 00	 and	 DWORD PTR __$EHRec$[ebp+8], 0
  00021	85 c9		 test	 ecx, ecx
  00023	74 0e		 je	 SHORT $LN1@ioClientUD
  00025	8b 01		 mov	 eax, DWORD PTR [ecx]
  00027	6a 01		 push	 1
  00029	ff 50 24	 call	 DWORD PTR [eax+36]
  0002c	83 a7 40 81 00
	00 00		 and	 DWORD PTR [edi+33088], 0
$LN1@ioClientUD:

; 19   : }

  00033	83 4d fc ff	 or	 DWORD PTR __$EHRec$[ebp+8], -1
  00037	8b cf		 mov	 ecx, edi
  00039	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_??1ioUDPSocket@@UAE@XZ
  0003f	e8 00 00 00 00	 call	 __EH_epilog3
  00044	c3		 ret	 0
_TEXT	ENDS
;	COMDAT text$x
text$x	SEGMENT
__unwindfunclet$??1ioClientUDPSocket@@UAE@XZ$0:
  00000	8b 4d f0	 mov	 ecx, DWORD PTR _this$[ebp]
  00003	ff 25 00 00 00
	00		 jmp	 DWORD PTR __imp_??1ioUDPSocket@@UAE@XZ
__ehhandler$??1ioClientUDPSocket@@UAE@XZ:
  00009	8b 54 24 08	 mov	 edx, DWORD PTR [esp+8]
  0000d	8d 42 0c	 lea	 eax, DWORD PTR [edx+12]
  00010	8b 4a ec	 mov	 ecx, DWORD PTR [edx-20]
  00013	33 c8		 xor	 ecx, eax
  00015	e8 00 00 00 00	 call	 @__security_check_cookie@4
  0001a	b8 00 00 00 00	 mov	 eax, OFFSET __ehfuncinfo$??1ioClientUDPSocket@@UAE@XZ
  0001f	e9 00 00 00 00	 jmp	 ___CxxFrameHandler3
text$x	ENDS
??1ioClientUDPSocket@@UAE@XZ ENDP			; ioClientUDPSocket::~ioClientUDPSocket
PUBLIC	??_C@_0EH@OEBAIPOC@ioClientUDPSocket?3?3CheckNS?5Type?3@ ; `string'
PUBLIC	??_C@_0DB@HFJBMAEI@ioClientUDPSocket?3?3CheckNS?5Check@ ; `string'
PUBLIC	??_C@_0CN@IHPAEBJJ@ioClientUDPSocket?3?3CheckNS?5?$CI?5m_p@ ; `string'
EXTRN	__imp_?GetState@CPacket@@QBEHXZ:PROC
EXTRN	__imp_?GetPacketID@CPacket@@QBEKXZ:PROC
EXTRN	__imp_?PrintTimeAndLog@CLog@@QAAXHPADZZ:PROC
EXTRN	__imp_?LOG@@3VCLog@@A:BYTE
;	COMDAT ??_C@_0EH@OEBAIPOC@ioClientUDPSocket?3?3CheckNS?5Type?3@
CONST	SEGMENT
??_C@_0EH@OEBAIPOC@ioClientUDPSocket?3?3CheckNS?5Type?3@ DB 'ioClientUDPS'
	DB	'ocket::CheckNS Type:%x State Not Same Client:%d, Server:%d', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0DB@HFJBMAEI@ioClientUDPSocket?3?3CheckNS?5Check@
CONST	SEGMENT
??_C@_0DB@HFJBMAEI@ioClientUDPSocket?3?3CheckNS?5Check@ DB 'ioClientUDPSo'
	DB	'cket::CheckNS Check Sum Fail!! [%d]', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0CN@IHPAEBJJ@ioClientUDPSocket?3?3CheckNS?5?$CI?5m_p@
CONST	SEGMENT
??_C@_0CN@IHPAEBJJ@ioClientUDPSocket?3?3CheckNS?5?$CI?5m_p@ DB 'ioClientU'
	DB	'DPSocket::CheckNS ( m_pNS == NULL )', 00H	; `string'
; Function compile flags: /Ogsp
CONST	ENDS
;	COMDAT ?CheckNS@ioClientUDPSocket@@UAE_NAAVCPacket@@@Z
_TEXT	SEGMENT
_rkPacket$ = 8						; size = 4
?CheckNS@ioClientUDPSocket@@UAE_NAAVCPacket@@@Z PROC	; ioClientUDPSocket::CheckNS, COMDAT
; _this$ = ecx

; 30   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi
  00004	8b f1		 mov	 esi, ecx

; 31   : 	if( m_pNS == NULL )

  00006	83 be 40 81 00
	00 00		 cmp	 DWORD PTR [esi+33088], 0
  0000d	75 1d		 jne	 SHORT $LN3@CheckNS

; 32   : 	{
; 33   : 		LOG.PrintTimeAndLog( 0, "ioClientUDPSocket::CheckNS ( m_pNS == NULL )");

  0000f	68 00 00 00 00	 push	 OFFSET ??_C@_0CN@IHPAEBJJ@ioClientUDPSocket?3?3CheckNS?5?$CI?5m_p@
  00014	6a 00		 push	 0
  00016	ff 35 00 00 00
	00		 push	 DWORD PTR __imp_?LOG@@3VCLog@@A
  0001c	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?PrintTimeAndLog@CLog@@QAAXHPADZZ
  00022	83 c4 0c	 add	 esp, 12			; 0000000cH

; 34   : 		return true;

  00025	b0 01		 mov	 al, 1
  00027	e9 80 00 00 00	 jmp	 $LN4@CheckNS
$LN3@CheckNS:

; 35   : 	}
; 36   : 	
; 37   : 	if( !m_pNS->IsCheckSum( rkPacket ) )

  0002c	8b 8e 40 81 00
	00		 mov	 ecx, DWORD PTR [esi+33088]
  00032	8b 01		 mov	 eax, DWORD PTR [ecx]
  00034	57		 push	 edi
  00035	8b 7d 08	 mov	 edi, DWORD PTR _rkPacket$[ebp]
  00038	57		 push	 edi
  00039	ff 50 04	 call	 DWORD PTR [eax+4]
  0003c	84 c0		 test	 al, al
  0003e	75 21		 jne	 SHORT $LN2@CheckNS

; 38   : 	{
; 39   : 		LOG.PrintTimeAndLog( 0, "ioClientUDPSocket::CheckNS Check Sum Fail!! [%d]", rkPacket.GetPacketID() );

  00040	8b cf		 mov	 ecx, edi
  00042	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?GetPacketID@CPacket@@QBEKXZ
  00048	50		 push	 eax
  00049	68 00 00 00 00	 push	 OFFSET ??_C@_0DB@HFJBMAEI@ioClientUDPSocket?3?3CheckNS?5Check@
  0004e	6a 00		 push	 0
  00050	ff 35 00 00 00
	00		 push	 DWORD PTR __imp_?LOG@@3VCLog@@A
  00056	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?PrintTimeAndLog@CLog@@QAAXHPADZZ
  0005c	83 c4 10	 add	 esp, 16			; 00000010H

; 40   : 		return false;

  0005f	eb 44		 jmp	 SHORT $LN7@CheckNS
$LN2@CheckNS:

; 41   : 	}
; 42   : 	
; 43   : 	if( !m_pNS->CheckState( rkPacket ) )

  00061	8b 8e 40 81 00
	00		 mov	 ecx, DWORD PTR [esi+33088]
  00067	8b 01		 mov	 eax, DWORD PTR [ecx]
  00069	57		 push	 edi
  0006a	ff 50 18	 call	 DWORD PTR [eax+24]
  0006d	84 c0		 test	 al, al
  0006f	75 38		 jne	 SHORT $LN1@CheckNS

; 44   : 	{
; 45   : 		LOG.PrintTimeAndLog( 0, "ioClientUDPSocket::CheckNS Type:%x State Not Same Client:%d, Server:%d", 
; 46   : 							     rkPacket.GetPacketID(),
; 47   : 								 rkPacket.GetState(),
; 48   : 								 m_pNS->GetRcvState() );

  00071	8b 8e 40 81 00
	00		 mov	 ecx, DWORD PTR [esi+33088]
  00077	8b 01		 mov	 eax, DWORD PTR [ecx]
  00079	ff 50 10	 call	 DWORD PTR [eax+16]
  0007c	50		 push	 eax
  0007d	8b cf		 mov	 ecx, edi
  0007f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?GetState@CPacket@@QBEHXZ
  00085	50		 push	 eax
  00086	8b cf		 mov	 ecx, edi
  00088	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?GetPacketID@CPacket@@QBEKXZ
  0008e	50		 push	 eax
  0008f	68 00 00 00 00	 push	 OFFSET ??_C@_0EH@OEBAIPOC@ioClientUDPSocket?3?3CheckNS?5Type?3@
  00094	6a 00		 push	 0
  00096	ff 35 00 00 00
	00		 push	 DWORD PTR __imp_?LOG@@3VCLog@@A
  0009c	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?PrintTimeAndLog@CLog@@QAAXHPADZZ
  000a2	83 c4 18	 add	 esp, 24			; 00000018H
$LN7@CheckNS:

; 49   : 		return false;

  000a5	32 c0		 xor	 al, al
  000a7	eb 02		 jmp	 SHORT $LN6@CheckNS
$LN1@CheckNS:

; 50   : 	}
; 51   : 	
; 52   : 	return true;

  000a9	b0 01		 mov	 al, 1
$LN6@CheckNS:
  000ab	5f		 pop	 edi
$LN4@CheckNS:
  000ac	5e		 pop	 esi

; 53   : }

  000ad	5d		 pop	 ebp
  000ae	c2 04 00	 ret	 4
?CheckNS@ioClientUDPSocket@@UAE_NAAVCPacket@@@Z ENDP	; ioClientUDPSocket::CheckNS
_TEXT	ENDS
EXTRN	?RecvPacket@P2PNetwork@@YAXAAVSP2Packet@@PADH@Z:PROC ; P2PNetwork::RecvPacket
; Function compile flags: /Ogsp
;	COMDAT ?ProcessPacket@ioClientUDPSocket@@UAEXAAVCPacket@@PADH@Z
_TEXT	SEGMENT
_rkPacket$ = 8						; size = 4
_RcvIP$ = 12						; size = 4
_iRcvPort$ = 16						; size = 4
?ProcessPacket@ioClientUDPSocket@@UAEXAAVCPacket@@PADH@Z PROC ; ioClientUDPSocket::ProcessPacket, COMDAT
; _this$ = ecx

; 56   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 57   : 	P2PNetwork::RecvPacket( (SP2Packet&)rkPacket, RcvIP, iRcvPort );

  00003	ff 75 10	 push	 DWORD PTR _iRcvPort$[ebp]
  00006	ff 75 0c	 push	 DWORD PTR _RcvIP$[ebp]
  00009	ff 75 08	 push	 DWORD PTR _rkPacket$[ebp]
  0000c	e8 00 00 00 00	 call	 ?RecvPacket@P2PNetwork@@YAXAAVSP2Packet@@PADH@Z ; P2PNetwork::RecvPacket
  00011	83 c4 0c	 add	 esp, 12			; 0000000cH

; 58   : }

  00014	5d		 pop	 ebp
  00015	c2 0c 00	 ret	 12			; 0000000cH
?ProcessPacket@ioClientUDPSocket@@UAEXAAVCPacket@@PADH@Z ENDP ; ioClientUDPSocket::ProcessPacket
_TEXT	ENDS
PUBLIC	??_7ioUDPClientSecurity@@6B@			; ioUDPClientSecurity::`vftable'
PUBLIC	??0ioUDPClientSecurity@@QAE@XZ			; ioUDPClientSecurity::ioUDPClientSecurity
PUBLIC	??_R4ioUDPClientSecurity@@6B@			; ioUDPClientSecurity::`RTTI Complete Object Locator'
PUBLIC	??_R0?AVioUDPClientSecurity@@@8			; ioUDPClientSecurity `RTTI Type Descriptor'
PUBLIC	??_R3ioUDPClientSecurity@@8			; ioUDPClientSecurity::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2ioUDPClientSecurity@@8			; ioUDPClientSecurity::`RTTI Base Class Array'
PUBLIC	??_R1A@?0A@EA@ioUDPClientSecurity@@8		; ioUDPClientSecurity::`RTTI Base Class Descriptor at (0,-1,0,64)'
PUBLIC	??_R1A@?0A@EA@NetworkSecurity@@8		; NetworkSecurity::`RTTI Base Class Descriptor at (0,-1,0,64)'
PUBLIC	??_R0?AVNetworkSecurity@@@8			; NetworkSecurity `RTTI Type Descriptor'
PUBLIC	??_R3NetworkSecurity@@8				; NetworkSecurity::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2NetworkSecurity@@8				; NetworkSecurity::`RTTI Base Class Array'
PUBLIC	?IsCheckSum@ioUDPClientSecurity@@UAE_NAAVCPacket@@@Z ; ioUDPClientSecurity::IsCheckSum
PUBLIC	?GetSndState@ioUDPClientSecurity@@UAEHXZ	; ioUDPClientSecurity::GetSndState
PUBLIC	?UpdateSndState@ioUDPClientSecurity@@UAEXXZ	; ioUDPClientSecurity::UpdateSndState
PUBLIC	?GetRcvState@ioUDPClientSecurity@@UAEHXZ	; ioUDPClientSecurity::GetRcvState
PUBLIC	?UpdateRcvState@ioUDPClientSecurity@@UAEXXZ	; ioUDPClientSecurity::UpdateRcvState
PUBLIC	?CheckState@ioUDPClientSecurity@@UAE_NAAVCPacket@@@Z ; ioUDPClientSecurity::CheckState
PUBLIC	?PrepareMsg@ioUDPClientSecurity@@UAEXAAVCPacket@@@Z ; ioUDPClientSecurity::PrepareMsg
PUBLIC	?CompletionMsg@ioUDPClientSecurity@@UAEXAAVCPacket@@@Z ; ioUDPClientSecurity::CompletionMsg
EXTRN	__imp_??1NetworkSecurity@@UAE@XZ:PROC
EXTRN	__imp_?InitState@FSM@@QAEXXZ:PROC
EXTRN	__imp_??0FSM@@QAE@XZ:PROC
EXTRN	__imp_??0NetworkSecurity@@QAE@XZ:PROC
EXTRN	?UpdateReceiveCount@NetworkSecurity@@UAE_NXZ:PROC ; NetworkSecurity::UpdateReceiveCount
EXTRN	??_EioUDPClientSecurity@@UAEPAXI@Z:PROC		; ioUDPClientSecurity::`vector deleting destructor'
;	COMDAT ??_R2NetworkSecurity@@8
rdata$r	SEGMENT
??_R2NetworkSecurity@@8 DD FLAT:??_R1A@?0A@EA@NetworkSecurity@@8 ; NetworkSecurity::`RTTI Base Class Array'
rdata$r	ENDS
;	COMDAT ??_R3NetworkSecurity@@8
rdata$r	SEGMENT
??_R3NetworkSecurity@@8 DD 00H				; NetworkSecurity::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	01H
	DD	FLAT:??_R2NetworkSecurity@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVNetworkSecurity@@@8
_DATA	SEGMENT
??_R0?AVNetworkSecurity@@@8 DD FLAT:??_7type_info@@6B@	; NetworkSecurity `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVNetworkSecurity@@', 00H
_DATA	ENDS
;	COMDAT ??_R1A@?0A@EA@NetworkSecurity@@8
rdata$r	SEGMENT
??_R1A@?0A@EA@NetworkSecurity@@8 DD FLAT:??_R0?AVNetworkSecurity@@@8 ; NetworkSecurity::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	00H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3NetworkSecurity@@8
rdata$r	ENDS
;	COMDAT ??_R1A@?0A@EA@ioUDPClientSecurity@@8
rdata$r	SEGMENT
??_R1A@?0A@EA@ioUDPClientSecurity@@8 DD FLAT:??_R0?AVioUDPClientSecurity@@@8 ; ioUDPClientSecurity::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	01H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3ioUDPClientSecurity@@8
rdata$r	ENDS
;	COMDAT ??_R2ioUDPClientSecurity@@8
rdata$r	SEGMENT
??_R2ioUDPClientSecurity@@8 DD FLAT:??_R1A@?0A@EA@ioUDPClientSecurity@@8 ; ioUDPClientSecurity::`RTTI Base Class Array'
	DD	FLAT:??_R1A@?0A@EA@NetworkSecurity@@8
rdata$r	ENDS
;	COMDAT ??_R3ioUDPClientSecurity@@8
rdata$r	SEGMENT
??_R3ioUDPClientSecurity@@8 DD 00H			; ioUDPClientSecurity::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	02H
	DD	FLAT:??_R2ioUDPClientSecurity@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVioUDPClientSecurity@@@8
_DATA	SEGMENT
??_R0?AVioUDPClientSecurity@@@8 DD FLAT:??_7type_info@@6B@ ; ioUDPClientSecurity `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVioUDPClientSecurity@@', 00H
_DATA	ENDS
;	COMDAT ??_R4ioUDPClientSecurity@@6B@
rdata$r	SEGMENT
??_R4ioUDPClientSecurity@@6B@ DD 00H			; ioUDPClientSecurity::`RTTI Complete Object Locator'
	DD	00H
	DD	00H
	DD	FLAT:??_R0?AVioUDPClientSecurity@@@8
	DD	FLAT:??_R3ioUDPClientSecurity@@8
rdata$r	ENDS
;	COMDAT ??_7ioUDPClientSecurity@@6B@
CONST	SEGMENT
??_7ioUDPClientSecurity@@6B@ DD FLAT:??_R4ioUDPClientSecurity@@6B@ ; ioUDPClientSecurity::`vftable'
	DD	FLAT:?UpdateReceiveCount@NetworkSecurity@@UAE_NXZ
	DD	FLAT:?IsCheckSum@ioUDPClientSecurity@@UAE_NAAVCPacket@@@Z
	DD	FLAT:?GetSndState@ioUDPClientSecurity@@UAEHXZ
	DD	FLAT:?UpdateSndState@ioUDPClientSecurity@@UAEXXZ
	DD	FLAT:?GetRcvState@ioUDPClientSecurity@@UAEHXZ
	DD	FLAT:?UpdateRcvState@ioUDPClientSecurity@@UAEXXZ
	DD	FLAT:?CheckState@ioUDPClientSecurity@@UAE_NAAVCPacket@@@Z
	DD	FLAT:?PrepareMsg@ioUDPClientSecurity@@UAEXAAVCPacket@@@Z
	DD	FLAT:?CompletionMsg@ioUDPClientSecurity@@UAEXAAVCPacket@@@Z
	DD	FLAT:??_EioUDPClientSecurity@@UAEPAXI@Z
CONST	ENDS
;	COMDAT xdata$x
xdata$x	SEGMENT
__unwindtable$??0ioUDPClientSecurity@@QAE@XZ DD 0ffffffffH
	DD	FLAT:__unwindfunclet$??0ioUDPClientSecurity@@QAE@XZ$0
__ehfuncinfo$??0ioUDPClientSecurity@@QAE@XZ DD 019930522H
	DD	01H
	DD	FLAT:__unwindtable$??0ioUDPClientSecurity@@QAE@XZ
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
; Function compile flags: /Ogsp
xdata$x	ENDS
;	COMDAT ??0ioUDPClientSecurity@@QAE@XZ
_TEXT	SEGMENT
_this$ = -16						; size = 4
__$EHRec$ = -12						; size = 12
??0ioUDPClientSecurity@@QAE@XZ PROC			; ioUDPClientSecurity::ioUDPClientSecurity, COMDAT
; _this$ = ecx

; 62   : {

  00000	6a 04		 push	 4
  00002	b8 00 00 00 00	 mov	 eax, __ehhandler$??0ioUDPClientSecurity@@QAE@XZ
  00007	e8 00 00 00 00	 call	 __EH_prolog3
  0000c	8b f1		 mov	 esi, ecx
  0000e	89 75 f0	 mov	 DWORD PTR _this$[ebp], esi
  00011	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_??0NetworkSecurity@@QAE@XZ
  00017	8b 3d 00 00 00
	00		 mov	 edi, DWORD PTR __imp_??0FSM@@QAE@XZ
  0001d	83 65 fc 00	 and	 DWORD PTR __$EHRec$[ebp+8], 0
  00021	8d 4e 04	 lea	 ecx, DWORD PTR [esi+4]
  00024	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET ??_7ioUDPClientSecurity@@6B@
  0002a	ff d7		 call	 edi
  0002c	8d 4e 08	 lea	 ecx, DWORD PTR [esi+8]
  0002f	ff d7		 call	 edi

; 63   : 	m_SndState.InitState();

  00031	8b 3d 00 00 00
	00		 mov	 edi, DWORD PTR __imp_?InitState@FSM@@QAEXXZ
  00037	8d 4e 04	 lea	 ecx, DWORD PTR [esi+4]
  0003a	ff d7		 call	 edi

; 64   : 	m_RcvState.InitState();

  0003c	8d 4e 08	 lea	 ecx, DWORD PTR [esi+8]
  0003f	ff d7		 call	 edi

; 65   : }

  00041	8b c6		 mov	 eax, esi
  00043	e8 00 00 00 00	 call	 __EH_epilog3
  00048	c3		 ret	 0
_TEXT	ENDS
;	COMDAT text$x
text$x	SEGMENT
__unwindfunclet$??0ioUDPClientSecurity@@QAE@XZ$0:
  00000	8b 4d f0	 mov	 ecx, DWORD PTR _this$[ebp]
  00003	ff 25 00 00 00
	00		 jmp	 DWORD PTR __imp_??1NetworkSecurity@@UAE@XZ
__ehhandler$??0ioUDPClientSecurity@@QAE@XZ:
  00009	8b 54 24 08	 mov	 edx, DWORD PTR [esp+8]
  0000d	8d 42 0c	 lea	 eax, DWORD PTR [edx+12]
  00010	8b 4a ec	 mov	 ecx, DWORD PTR [edx-20]
  00013	33 c8		 xor	 ecx, eax
  00015	e8 00 00 00 00	 call	 @__security_check_cookie@4
  0001a	b8 00 00 00 00	 mov	 eax, OFFSET __ehfuncinfo$??0ioUDPClientSecurity@@QAE@XZ
  0001f	e9 00 00 00 00	 jmp	 ___CxxFrameHandler3
text$x	ENDS
??0ioUDPClientSecurity@@QAE@XZ ENDP			; ioUDPClientSecurity::ioUDPClientSecurity
PUBLIC	??1ioUDPClientSecurity@@UAE@XZ			; ioUDPClientSecurity::~ioUDPClientSecurity
; Function compile flags: /Ogsp
;	COMDAT ??1ioUDPClientSecurity@@UAE@XZ
_TEXT	SEGMENT
??1ioUDPClientSecurity@@UAE@XZ PROC			; ioUDPClientSecurity::~ioUDPClientSecurity, COMDAT
; _this$ = ecx

; 68   : {

  00000	c7 01 00 00 00
	00		 mov	 DWORD PTR [ecx], OFFSET ??_7ioUDPClientSecurity@@6B@

; 69   : }

  00006	ff 25 00 00 00
	00		 jmp	 DWORD PTR __imp_??1NetworkSecurity@@UAE@XZ
??1ioUDPClientSecurity@@UAE@XZ ENDP			; ioUDPClientSecurity::~ioUDPClientSecurity
_TEXT	ENDS
PUBLIC	?RcvPeerInfo@ioUDPClientSecurity@@QAEXPADH@Z	; ioUDPClientSecurity::RcvPeerInfo
EXTRN	__imp__sprintf:PROC
; Function compile flags: /Ogsp
;	COMDAT ?RcvPeerInfo@ioUDPClientSecurity@@QAEXPADH@Z
_TEXT	SEGMENT
_iip$ = 8						; size = 4
_iPort$ = 12						; size = 4
?RcvPeerInfo@ioUDPClientSecurity@@QAEXPADH@Z PROC	; ioUDPClientSecurity::RcvPeerInfo, COMDAT
; _this$ = ecx

; 72   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi

; 73   : 	sprintf( m_recent_rcv_ip, iip );

  00004	ff 75 08	 push	 DWORD PTR _iip$[ebp]
  00007	8b f1		 mov	 esi, ecx
  00009	8d 46 0c	 lea	 eax, DWORD PTR [esi+12]
  0000c	50		 push	 eax
  0000d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__sprintf

; 74   : 	m_recent_rcv_port = iPort;

  00013	8b 45 0c	 mov	 eax, DWORD PTR _iPort$[ebp]
  00016	59		 pop	 ecx
  00017	59		 pop	 ecx
  00018	89 46 1c	 mov	 DWORD PTR [esi+28], eax
  0001b	5e		 pop	 esi

; 75   : }

  0001c	5d		 pop	 ebp
  0001d	c2 08 00	 ret	 8
?RcvPeerInfo@ioUDPClientSecurity@@QAEXPADH@Z ENDP	; ioUDPClientSecurity::RcvPeerInfo
_TEXT	ENDS
PUBLIC	?EncryptMsg@ioUDPClientSecurity@@IAEXAAVCPacket@@@Z ; ioUDPClientSecurity::EncryptMsg
EXTRN	__imp_?Encrypt@@YAXPAEH@Z:PROC
EXTRN	__imp_?SetCheckSum@CPacket@@QAEXK@Z:PROC
EXTRN	__imp_?MakeDigest@@YAKPAEH@Z:PROC
EXTRN	__imp_?GetBuffer@CPacket@@QBEPBDXZ:PROC
EXTRN	__imp_?GetBufferSize@CPacket@@QBEHXZ:PROC
; Function compile flags: /Ogsp
;	COMDAT ?EncryptMsg@ioUDPClientSecurity@@IAEXAAVCPacket@@@Z
_TEXT	SEGMENT
_rkPacket$ = 8						; size = 4
?EncryptMsg@ioUDPClientSecurity@@IAEXAAVCPacket@@@Z PROC ; ioUDPClientSecurity::EncryptMsg, COMDAT
; _this$ = ecx

; 79   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	53		 push	 ebx

; 80   : 	// Check Sum
; 81   : 	DWORD dwResult = MakeDigest(  (BYTE*)rkPacket.GetBuffer(), rkPacket.GetBufferSize()  );

  00004	8b 5d 08	 mov	 ebx, DWORD PTR _rkPacket$[ebp]
  00007	56		 push	 esi
  00008	8b 35 00 00 00
	00		 mov	 esi, DWORD PTR __imp_?GetBufferSize@CPacket@@QBEHXZ
  0000e	57		 push	 edi
  0000f	8b cb		 mov	 ecx, ebx
  00011	ff d6		 call	 esi
  00013	8b 3d 00 00 00
	00		 mov	 edi, DWORD PTR __imp_?GetBuffer@CPacket@@QBEPBDXZ
  00019	50		 push	 eax
  0001a	8b cb		 mov	 ecx, ebx
  0001c	ff d7		 call	 edi
  0001e	50		 push	 eax
  0001f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?MakeDigest@@YAKPAEH@Z
  00025	59		 pop	 ecx
  00026	59		 pop	 ecx

; 82   : 	rkPacket.SetCheckSum( dwResult );

  00027	50		 push	 eax
  00028	8b cb		 mov	 ecx, ebx
  0002a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?SetCheckSum@CPacket@@QAEXK@Z

; 83   : 	
; 84   : 	// Encryption
; 85   : 	BYTE *pSrc;
; 86   : 	pSrc = (BYTE*)rkPacket.GetBuffer() + PK_CKSUM_ADDR;

  00030	8b cb		 mov	 ecx, ebx
  00032	ff d7		 call	 edi

; 87   : 	Encrypt( pSrc, rkPacket.GetBufferSize() - PK_CKSUM_ADDR );	

  00034	8b cb		 mov	 ecx, ebx
  00036	8d 78 08	 lea	 edi, DWORD PTR [eax+8]
  00039	ff d6		 call	 esi
  0003b	83 e8 08	 sub	 eax, 8
  0003e	50		 push	 eax
  0003f	57		 push	 edi
  00040	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?Encrypt@@YAXPAEH@Z
  00046	59		 pop	 ecx
  00047	59		 pop	 ecx
  00048	5f		 pop	 edi
  00049	5e		 pop	 esi
  0004a	5b		 pop	 ebx

; 88   : }

  0004b	5d		 pop	 ebp
  0004c	c2 04 00	 ret	 4
?EncryptMsg@ioUDPClientSecurity@@IAEXAAVCPacket@@@Z ENDP ; ioUDPClientSecurity::EncryptMsg
_TEXT	ENDS
PUBLIC	?DecryptMsg@ioUDPClientSecurity@@IAEXAAVCPacket@@@Z ; ioUDPClientSecurity::DecryptMsg
EXTRN	__imp_?Decrypt@@YAXPAEH@Z:PROC
; Function compile flags: /Ogsp
;	COMDAT ?DecryptMsg@ioUDPClientSecurity@@IAEXAAVCPacket@@@Z
_TEXT	SEGMENT
_rkPacket$ = 8						; size = 4
?DecryptMsg@ioUDPClientSecurity@@IAEXAAVCPacket@@@Z PROC ; ioUDPClientSecurity::DecryptMsg, COMDAT
; _this$ = ecx

; 91   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 92   : 	// Decryption
; 93   : 	BYTE *pSrc;
; 94   : 	pSrc = (BYTE*)rkPacket.GetBuffer() + PK_CKSUM_ADDR;

  00003	8b 4d 08	 mov	 ecx, DWORD PTR _rkPacket$[ebp]
  00006	56		 push	 esi
  00007	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?GetBuffer@CPacket@@QBEPBDXZ

; 95   : 	Decrypt( pSrc, rkPacket.GetBufferSize() - PK_CKSUM_ADDR );

  0000d	8b 4d 08	 mov	 ecx, DWORD PTR _rkPacket$[ebp]
  00010	8d 70 08	 lea	 esi, DWORD PTR [eax+8]
  00013	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?GetBufferSize@CPacket@@QBEHXZ
  00019	83 e8 08	 sub	 eax, 8
  0001c	50		 push	 eax
  0001d	56		 push	 esi
  0001e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?Decrypt@@YAXPAEH@Z
  00024	59		 pop	 ecx
  00025	59		 pop	 ecx
  00026	5e		 pop	 esi

; 96   : }

  00027	5d		 pop	 ebp
  00028	c2 04 00	 ret	 4
?DecryptMsg@ioUDPClientSecurity@@IAEXAAVCPacket@@@Z ENDP ; ioUDPClientSecurity::DecryptMsg
_TEXT	ENDS
PUBLIC	??_C@_0BK@DMLNPEAL@Check?5Sum?5Fail?$CB?3?5?$CFd?5?$CB?$DN?5?$CFd?$AA@ ; `string'
EXTRN	__imp_?GetCheckSum@CPacket@@QBEKXZ:PROC
;	COMDAT ??_C@_0BK@DMLNPEAL@Check?5Sum?5Fail?$CB?3?5?$CFd?5?$CB?$DN?5?$CFd?$AA@
CONST	SEGMENT
??_C@_0BK@DMLNPEAL@Check?5Sum?5Fail?$CB?3?5?$CFd?5?$CB?$DN?5?$CFd?$AA@ DB 'C'
	DB	'heck Sum Fail!: %d != %d', 00H		; `string'
; Function compile flags: /Ogsp
CONST	ENDS
;	COMDAT ?IsCheckSum@ioUDPClientSecurity@@UAE_NAAVCPacket@@@Z
_TEXT	SEGMENT
_dwResult$ = 8						; size = 4
_rkPacket$ = 8						; size = 4
?IsCheckSum@ioUDPClientSecurity@@UAE_NAAVCPacket@@@Z PROC ; ioUDPClientSecurity::IsCheckSum, COMDAT
; _this$ = ecx

; 99   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	53		 push	 ebx
  00004	56		 push	 esi
  00005	57		 push	 edi

; 100  : 	//Decrypt
; 101  : 	DecryptMsg( rkPacket );

  00006	8b 7d 08	 mov	 edi, DWORD PTR _rkPacket$[ebp]
  00009	57		 push	 edi
  0000a	e8 00 00 00 00	 call	 ?DecryptMsg@ioUDPClientSecurity@@IAEXAAVCPacket@@@Z ; ioUDPClientSecurity::DecryptMsg

; 102  : 
; 103  : 	DWORD	dwTemp = rkPacket.GetCheckSum();   //임시 저장.

  0000f	8b cf		 mov	 ecx, edi
  00011	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?GetCheckSum@CPacket@@QBEKXZ

; 104  : 	rkPacket.SetCheckSum( 0 );

  00017	8b 35 00 00 00
	00		 mov	 esi, DWORD PTR __imp_?SetCheckSum@CPacket@@QAEXK@Z
  0001d	6a 00		 push	 0
  0001f	8b cf		 mov	 ecx, edi
  00021	8b d8		 mov	 ebx, eax
  00023	ff d6		 call	 esi

; 105  : 	
; 106  : 	DWORD dwResult = MakeDigest( (BYTE*)rkPacket.GetBuffer(), rkPacket.GetBufferSize() );

  00025	8b cf		 mov	 ecx, edi
  00027	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?GetBufferSize@CPacket@@QBEHXZ
  0002d	50		 push	 eax
  0002e	8b cf		 mov	 ecx, edi
  00030	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?GetBuffer@CPacket@@QBEPBDXZ
  00036	50		 push	 eax
  00037	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?MakeDigest@@YAKPAEH@Z
  0003d	59		 pop	 ecx
  0003e	59		 pop	 ecx

; 107  : 
; 108  : 	rkPacket.SetCheckSum( dwTemp );

  0003f	53		 push	 ebx
  00040	8b cf		 mov	 ecx, edi
  00042	89 45 08	 mov	 DWORD PTR _dwResult$[ebp], eax
  00045	ff d6		 call	 esi

; 109  : 
; 110  : 	if( dwResult != dwTemp )

  00047	39 5d 08	 cmp	 DWORD PTR _dwResult$[ebp], ebx
  0004a	74 1e		 je	 SHORT $LN1@IsCheckSum

; 111  : 	{
; 112  : 		LOG.PrintTimeAndLog( 0, "Check Sum Fail!: %d != %d", dwResult, dwTemp );

  0004c	53		 push	 ebx
  0004d	ff 75 08	 push	 DWORD PTR _dwResult$[ebp]
  00050	68 00 00 00 00	 push	 OFFSET ??_C@_0BK@DMLNPEAL@Check?5Sum?5Fail?$CB?3?5?$CFd?5?$CB?$DN?5?$CFd?$AA@
  00055	6a 00		 push	 0
  00057	ff 35 00 00 00
	00		 push	 DWORD PTR __imp_?LOG@@3VCLog@@A
  0005d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?PrintTimeAndLog@CLog@@QAAXHPADZZ
  00063	83 c4 14	 add	 esp, 20			; 00000014H

; 113  : 		return false;

  00066	32 c0		 xor	 al, al
  00068	eb 02		 jmp	 SHORT $LN2@IsCheckSum
$LN1@IsCheckSum:

; 114  : 	}
; 115  : 
; 116  : 	return true;

  0006a	b0 01		 mov	 al, 1
$LN2@IsCheckSum:
  0006c	5f		 pop	 edi
  0006d	5e		 pop	 esi
  0006e	5b		 pop	 ebx

; 117  : }

  0006f	5d		 pop	 ebp
  00070	c2 04 00	 ret	 4
?IsCheckSum@ioUDPClientSecurity@@UAE_NAAVCPacket@@@Z ENDP ; ioUDPClientSecurity::IsCheckSum
_TEXT	ENDS
EXTRN	__imp_?GetState@FSM@@QAEHXZ:PROC
; Function compile flags: /Ogsp
;	COMDAT ?GetSndState@ioUDPClientSecurity@@UAEHXZ
_TEXT	SEGMENT
?GetSndState@ioUDPClientSecurity@@UAEHXZ PROC		; ioUDPClientSecurity::GetSndState, COMDAT
; _this$ = ecx

; 122  : 	return m_SndState.GetState();

  00000	83 c1 04	 add	 ecx, 4
  00003	ff 25 00 00 00
	00		 jmp	 DWORD PTR __imp_?GetState@FSM@@QAEHXZ
?GetSndState@ioUDPClientSecurity@@UAEHXZ ENDP		; ioUDPClientSecurity::GetSndState
_TEXT	ENDS
EXTRN	__imp_?UpdateState@FSM@@QAEXXZ:PROC
; Function compile flags: /Ogsp
;	COMDAT ?UpdateSndState@ioUDPClientSecurity@@UAEXXZ
_TEXT	SEGMENT
?UpdateSndState@ioUDPClientSecurity@@UAEXXZ PROC	; ioUDPClientSecurity::UpdateSndState, COMDAT
; _this$ = ecx

; 127  : 	m_SndState.UpdateState();

  00000	83 c1 04	 add	 ecx, 4
  00003	ff 25 00 00 00
	00		 jmp	 DWORD PTR __imp_?UpdateState@FSM@@QAEXXZ
?UpdateSndState@ioUDPClientSecurity@@UAEXXZ ENDP	; ioUDPClientSecurity::UpdateSndState
; Function compile flags: /Ogsp
_TEXT	ENDS
;	COMDAT ?GetRcvState@ioUDPClientSecurity@@UAEHXZ
_TEXT	SEGMENT
?GetRcvState@ioUDPClientSecurity@@UAEHXZ PROC		; ioUDPClientSecurity::GetRcvState, COMDAT
; _this$ = ecx

; 132  : 	return m_RcvState.GetState();

  00000	83 c1 08	 add	 ecx, 8
  00003	ff 25 00 00 00
	00		 jmp	 DWORD PTR __imp_?GetState@FSM@@QAEHXZ
?GetRcvState@ioUDPClientSecurity@@UAEHXZ ENDP		; ioUDPClientSecurity::GetRcvState
; Function compile flags: /Ogsp
_TEXT	ENDS
;	COMDAT ?UpdateRcvState@ioUDPClientSecurity@@UAEXXZ
_TEXT	SEGMENT
?UpdateRcvState@ioUDPClientSecurity@@UAEXXZ PROC	; ioUDPClientSecurity::UpdateRcvState, COMDAT
; _this$ = ecx

; 137  : 	m_RcvState.UpdateState();

  00000	83 c1 08	 add	 ecx, 8
  00003	ff 25 00 00 00
	00		 jmp	 DWORD PTR __imp_?UpdateState@FSM@@QAEXXZ
?UpdateRcvState@ioUDPClientSecurity@@UAEXXZ ENDP	; ioUDPClientSecurity::UpdateRcvState
_TEXT	ENDS
EXTRN	__imp_?SetState@FSM@@QAEXH@Z:PROC
; Function compile flags: /Ogsp
;	COMDAT ?CheckState@ioUDPClientSecurity@@UAE_NAAVCPacket@@@Z
_TEXT	SEGMENT
_rkPacket$ = 8						; size = 4
?CheckState@ioUDPClientSecurity@@UAE_NAAVCPacket@@@Z PROC ; ioUDPClientSecurity::CheckState, COMDAT
; _this$ = ecx

; 141  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi
  00004	57		 push	 edi

; 142  : 	if( rkPacket.GetState() != MAGIC_TOKEN_FSM )

  00005	8b 3d 00 00 00
	00		 mov	 edi, DWORD PTR __imp_?GetState@CPacket@@QBEHXZ
  0000b	8b f1		 mov	 esi, ecx
  0000d	8b 4d 08	 mov	 ecx, DWORD PTR _rkPacket$[ebp]
  00010	ff d7		 call	 edi
  00012	83 f8 ff	 cmp	 eax, -1
  00015	74 76		 je	 SHORT $LN3@CheckState

; 143  : 	{
; 144  : 		if( GetRcvState() == rkPacket.GetState() )

  00017	8b 06		 mov	 eax, DWORD PTR [esi]
  00019	53		 push	 ebx
  0001a	8b ce		 mov	 ecx, esi
  0001c	ff 50 10	 call	 DWORD PTR [eax+16]
  0001f	8b 4d 08	 mov	 ecx, DWORD PTR _rkPacket$[ebp]
  00022	8b d8		 mov	 ebx, eax
  00024	ff d7		 call	 edi
  00026	3b d8		 cmp	 ebx, eax
  00028	5b		 pop	 ebx
  00029	75 3b		 jne	 SHORT $LN1@CheckState

; 145  : 		{
; 146  : 			if( !strcmp( m_recent_rcv_ip, m_pre_recent_rcv_ip ) && m_recent_rcv_port == m_pre_recent_rcv_port )

  0002b	8d 4e 20	 lea	 ecx, DWORD PTR [esi+32]
  0002e	8d 46 0c	 lea	 eax, DWORD PTR [esi+12]
$LL8@CheckState:
  00031	8a 10		 mov	 dl, BYTE PTR [eax]
  00033	3a 11		 cmp	 dl, BYTE PTR [ecx]
  00035	75 1a		 jne	 SHORT $LN9@CheckState
  00037	84 d2		 test	 dl, dl
  00039	74 12		 je	 SHORT $LN10@CheckState
  0003b	8a 50 01	 mov	 dl, BYTE PTR [eax+1]
  0003e	3a 51 01	 cmp	 dl, BYTE PTR [ecx+1]
  00041	75 0e		 jne	 SHORT $LN9@CheckState
  00043	83 c0 02	 add	 eax, 2
  00046	83 c1 02	 add	 ecx, 2
  00049	84 d2		 test	 dl, dl
  0004b	75 e4		 jne	 SHORT $LL8@CheckState
$LN10@CheckState:
  0004d	33 c0		 xor	 eax, eax
  0004f	eb 05		 jmp	 SHORT $LN11@CheckState
$LN9@CheckState:
  00051	1b c0		 sbb	 eax, eax
  00053	83 d8 ff	 sbb	 eax, -1
$LN11@CheckState:
  00056	85 c0		 test	 eax, eax
  00058	75 0c		 jne	 SHORT $LN1@CheckState
  0005a	8b 46 1c	 mov	 eax, DWORD PTR [esi+28]
  0005d	3b 46 30	 cmp	 eax, DWORD PTR [esi+48]
  00060	75 04		 jne	 SHORT $LN1@CheckState

; 147  : 			{
; 148  : 				return false;

  00062	32 c0		 xor	 al, al
  00064	eb 29		 jmp	 SHORT $LN4@CheckState
$LN1@CheckState:

; 149  : 			}
; 150  : 		}
; 151  : 		
; 152  : 		strcpy(m_pre_recent_rcv_ip, m_recent_rcv_ip);

  00066	8d 46 0c	 lea	 eax, DWORD PTR [esi+12]
  00069	8d 56 20	 lea	 edx, DWORD PTR [esi+32]
  0006c	2b d0		 sub	 edx, eax
$LL6@CheckState:
  0006e	8a 08		 mov	 cl, BYTE PTR [eax]
  00070	88 0c 02	 mov	 BYTE PTR [edx+eax], cl
  00073	40		 inc	 eax
  00074	84 c9		 test	 cl, cl
  00076	75 f6		 jne	 SHORT $LL6@CheckState

; 153  : 		m_pre_recent_rcv_port = m_recent_rcv_port;

  00078	8b 46 1c	 mov	 eax, DWORD PTR [esi+28]

; 154  : 
; 155  : 		m_RcvState.SetState( rkPacket.GetState() );

  0007b	8b 4d 08	 mov	 ecx, DWORD PTR _rkPacket$[ebp]
  0007e	89 46 30	 mov	 DWORD PTR [esi+48], eax
  00081	ff d7		 call	 edi
  00083	50		 push	 eax
  00084	8d 4e 08	 lea	 ecx, DWORD PTR [esi+8]
  00087	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?SetState@FSM@@QAEXH@Z
$LN3@CheckState:

; 156  : 	}
; 157  : 	return true;

  0008d	b0 01		 mov	 al, 1
$LN4@CheckState:
  0008f	5f		 pop	 edi
  00090	5e		 pop	 esi

; 158  : }

  00091	5d		 pop	 ebp
  00092	c2 04 00	 ret	 4
?CheckState@ioUDPClientSecurity@@UAE_NAAVCPacket@@@Z ENDP ; ioUDPClientSecurity::CheckState
_TEXT	ENDS
EXTRN	__imp_?SetState@CPacket@@QAEXH@Z:PROC
EXTRN	__imp__rand:PROC
; Function compile flags: /Ogsp
;	COMDAT ?PrepareMsg@ioUDPClientSecurity@@UAEXAAVCPacket@@@Z
_TEXT	SEGMENT
_rkPacket$ = 8						; size = 4
?PrepareMsg@ioUDPClientSecurity@@UAEXAAVCPacket@@@Z PROC ; ioUDPClientSecurity::PrepareMsg, COMDAT
; _this$ = ecx

; 161  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi
  00004	8b f1		 mov	 esi, ecx

; 162  : 	if( GetSndState() == MAGIC_TOKEN_FSM )	// First

  00006	8b 06		 mov	 eax, DWORD PTR [esi]
  00008	ff 50 08	 call	 DWORD PTR [eax+8]
  0000b	83 f8 ff	 cmp	 eax, -1
  0000e	75 10		 jne	 SHORT $LN1@PrepareMsg

; 163  : 		m_SndState.SetState( rand() );

  00010	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__rand
  00016	50		 push	 eax
  00017	8d 4e 04	 lea	 ecx, DWORD PTR [esi+4]
  0001a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?SetState@FSM@@QAEXH@Z
$LN1@PrepareMsg:

; 164  : 	
; 165  : 	rkPacket.SetCheckSum( 0 );

  00020	8b 4d 08	 mov	 ecx, DWORD PTR _rkPacket$[ebp]
  00023	6a 00		 push	 0
  00025	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?SetCheckSum@CPacket@@QAEXK@Z

; 166  : 	rkPacket.SetState( GetSndState() );

  0002b	8b 06		 mov	 eax, DWORD PTR [esi]
  0002d	8b ce		 mov	 ecx, esi
  0002f	ff 50 08	 call	 DWORD PTR [eax+8]
  00032	8b 4d 08	 mov	 ecx, DWORD PTR _rkPacket$[ebp]
  00035	50		 push	 eax
  00036	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_?SetState@CPacket@@QAEXH@Z

; 167  : 
; 168  : 	EncryptMsg( rkPacket );

  0003c	ff 75 08	 push	 DWORD PTR _rkPacket$[ebp]
  0003f	8b ce		 mov	 ecx, esi
  00041	e8 00 00 00 00	 call	 ?EncryptMsg@ioUDPClientSecurity@@IAEXAAVCPacket@@@Z ; ioUDPClientSecurity::EncryptMsg

; 169  : 
; 170  : 	UpdateSndState();

  00046	8b 06		 mov	 eax, DWORD PTR [esi]
  00048	8b ce		 mov	 ecx, esi
  0004a	ff 50 0c	 call	 DWORD PTR [eax+12]
  0004d	5e		 pop	 esi

; 171  : }

  0004e	5d		 pop	 ebp
  0004f	c2 04 00	 ret	 4
?PrepareMsg@ioUDPClientSecurity@@UAEXAAVCPacket@@@Z ENDP ; ioUDPClientSecurity::PrepareMsg
; Function compile flags: /Ogsp
_TEXT	ENDS
;	COMDAT ?CompletionMsg@ioUDPClientSecurity@@UAEXAAVCPacket@@@Z
_TEXT	SEGMENT
_rkPacket$ = 8						; size = 4
?CompletionMsg@ioUDPClientSecurity@@UAEXAAVCPacket@@@Z PROC ; ioUDPClientSecurity::CompletionMsg, COMDAT
; _this$ = ecx

; 174  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 176  : }

  00003	5d		 pop	 ebp

; 175  : 	DecryptMsg( rkPacket );	

  00004	e9 00 00 00 00	 jmp	 ?DecryptMsg@ioUDPClientSecurity@@IAEXAAVCPacket@@@Z ; ioUDPClientSecurity::DecryptMsg
?CompletionMsg@ioUDPClientSecurity@@UAEXAAVCPacket@@@Z ENDP ; ioUDPClientSecurity::CompletionMsg
_TEXT	ENDS
PUBLIC	??0ioClientUDPSocket@@QAE@H@Z			; ioClientUDPSocket::ioClientUDPSocket
EXTRN	??3@YAXPAX@Z:PROC				; operator delete
EXTRN	??2@YAPAXI@Z:PROC				; operator new
EXTRN	__imp_??0ioUDPSocket@@QAE@XZ:PROC
;	COMDAT xdata$x
xdata$x	SEGMENT
__unwindtable$??0ioClientUDPSocket@@QAE@H@Z DD 0ffffffffH
	DD	FLAT:__unwindfunclet$??0ioClientUDPSocket@@QAE@H@Z$0
	DD	00H
	DD	FLAT:__unwindfunclet$??0ioClientUDPSocket@@QAE@H@Z$1
__ehfuncinfo$??0ioClientUDPSocket@@QAE@H@Z DD 019930522H
	DD	02H
	DD	FLAT:__unwindtable$??0ioClientUDPSocket@@QAE@H@Z
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
; Function compile flags: /Ogsp
xdata$x	ENDS
;	COMDAT ??0ioClientUDPSocket@@QAE@H@Z
_TEXT	SEGMENT
_this$ = -16						; size = 4
__$EHRec$ = -12						; size = 12
$T505413 = 8						; size = 4
_iSecurity$ = 8						; size = 4
??0ioClientUDPSocket@@QAE@H@Z PROC			; ioClientUDPSocket::ioClientUDPSocket, COMDAT
; _this$ = ecx

; 9    : {

  00000	6a 04		 push	 4
  00002	b8 00 00 00 00	 mov	 eax, __ehhandler$??0ioClientUDPSocket@@QAE@H@Z
  00007	e8 00 00 00 00	 call	 __EH_prolog3
  0000c	8b f1		 mov	 esi, ecx
  0000e	89 75 f0	 mov	 DWORD PTR _this$[ebp], esi
  00011	ff 15 00 00 00
	00		 call	 DWORD PTR __imp_??0ioUDPSocket@@QAE@XZ
  00017	83 65 fc 00	 and	 DWORD PTR __$EHRec$[ebp+8], 0

; 10   : 	if( iSecurity == 1 )

  0001b	83 7d 08 01	 cmp	 DWORD PTR _iSecurity$[ebp], 1
  0001f	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET ??_7ioClientUDPSocket@@6B@
  00025	75 24		 jne	 SHORT $LN1@ioClientUD@2

; 11   : 	{
; 12   : 		m_pNS = new ioUDPClientSecurity;

  00027	6a 34		 push	 52			; 00000034H
  00029	e8 00 00 00 00	 call	 ??2@YAPAXI@Z		; operator new
  0002e	59		 pop	 ecx
  0002f	8b c8		 mov	 ecx, eax
  00031	89 4d 08	 mov	 DWORD PTR $T505413[ebp], ecx
  00034	c6 45 fc 01	 mov	 BYTE PTR __$EHRec$[ebp+8], 1
  00038	85 c9		 test	 ecx, ecx
  0003a	74 07		 je	 SHORT $LN4@ioClientUD@2
  0003c	e8 00 00 00 00	 call	 ??0ioUDPClientSecurity@@QAE@XZ ; ioUDPClientSecurity::ioUDPClientSecurity
  00041	eb 02		 jmp	 SHORT $LN5@ioClientUD@2
$LN4@ioClientUD@2:
  00043	33 c0		 xor	 eax, eax
$LN5@ioClientUD@2:
  00045	89 86 40 81 00
	00		 mov	 DWORD PTR [esi+33088], eax
$LN1@ioClientUD@2:

; 13   : 	}
; 14   : }

  0004b	8b c6		 mov	 eax, esi
  0004d	e8 00 00 00 00	 call	 __EH_epilog3
  00052	c2 04 00	 ret	 4
_TEXT	ENDS
;	COMDAT text$x
text$x	SEGMENT
__unwindfunclet$??0ioClientUDPSocket@@QAE@H@Z$0:
  00000	8b 4d f0	 mov	 ecx, DWORD PTR _this$[ebp]
  00003	ff 25 00 00 00
	00		 jmp	 DWORD PTR __imp_??1ioUDPSocket@@UAE@XZ
__unwindfunclet$??0ioClientUDPSocket@@QAE@H@Z$1:
  00009	ff 75 08	 push	 DWORD PTR $T505413[ebp]
  0000c	e8 00 00 00 00	 call	 ??3@YAXPAX@Z		; operator delete
  00011	59		 pop	 ecx
  00012	c3		 ret	 0
__ehhandler$??0ioClientUDPSocket@@QAE@H@Z:
  00013	8b 54 24 08	 mov	 edx, DWORD PTR [esp+8]
  00017	8d 42 0c	 lea	 eax, DWORD PTR [edx+12]
  0001a	8b 4a ec	 mov	 ecx, DWORD PTR [edx-20]
  0001d	33 c8		 xor	 ecx, eax
  0001f	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00024	b8 00 00 00 00	 mov	 eax, OFFSET __ehfuncinfo$??0ioClientUDPSocket@@QAE@H@Z
  00029	e9 00 00 00 00	 jmp	 ___CxxFrameHandler3
text$x	ENDS
??0ioClientUDPSocket@@QAE@H@Z ENDP			; ioClientUDPSocket::ioClientUDPSocket
; Function compile flags: /Ogsp
;	COMDAT ??_GioClientUDPSocket@@UAEPAXI@Z
_TEXT	SEGMENT
___flags$ = 8						; size = 4
??_GioClientUDPSocket@@UAEPAXI@Z PROC			; ioClientUDPSocket::`scalar deleting destructor', COMDAT
; _this$ = ecx
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi
  00004	8b f1		 mov	 esi, ecx
  00006	e8 00 00 00 00	 call	 ??1ioClientUDPSocket@@UAE@XZ ; ioClientUDPSocket::~ioClientUDPSocket
  0000b	f6 45 08 01	 test	 BYTE PTR ___flags$[ebp], 1
  0000f	74 07		 je	 SHORT $LN1@scalar
  00011	56		 push	 esi
  00012	e8 00 00 00 00	 call	 ??3@YAXPAX@Z		; operator delete
  00017	59		 pop	 ecx
$LN1@scalar:
  00018	8b c6		 mov	 eax, esi
  0001a	5e		 pop	 esi
  0001b	5d		 pop	 ebp
  0001c	c2 04 00	 ret	 4
??_GioClientUDPSocket@@UAEPAXI@Z ENDP			; ioClientUDPSocket::`scalar deleting destructor'
; Function compile flags: /Ogsp
_TEXT	ENDS
;	COMDAT ?RcvPeerInfo@ioClientUDPSocket@@UAEXPADH@Z
_TEXT	SEGMENT
_iip$ = 8						; size = 4
_iPort$ = 12						; size = 4
?RcvPeerInfo@ioClientUDPSocket@@UAEXPADH@Z PROC		; ioClientUDPSocket::RcvPeerInfo, COMDAT
; _this$ = ecx

; 22   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 23   : 	if( m_pNS )

  00003	8b 89 40 81 00
	00		 mov	 ecx, DWORD PTR [ecx+33088]
  00009	85 c9		 test	 ecx, ecx
  0000b	74 06		 je	 SHORT $LN1@RcvPeerInf

; 26   : 	}
; 27   : }

  0000d	5d		 pop	 ebp

; 24   : 	{
; 25   : 		((ioUDPClientSecurity*)m_pNS)->RcvPeerInfo( iip, iPort );

  0000e	e9 00 00 00 00	 jmp	 ?RcvPeerInfo@ioUDPClientSecurity@@QAEXPADH@Z ; ioUDPClientSecurity::RcvPeerInfo
$LN1@RcvPeerInf:

; 26   : 	}
; 27   : }

  00013	5d		 pop	 ebp
  00014	c2 08 00	 ret	 8
?RcvPeerInfo@ioClientUDPSocket@@UAEXPADH@Z ENDP		; ioClientUDPSocket::RcvPeerInfo
; Function compile flags: /Ogsp
_TEXT	ENDS
;	COMDAT ??_GioUDPClientSecurity@@UAEPAXI@Z
_TEXT	SEGMENT
___flags$ = 8						; size = 4
??_GioUDPClientSecurity@@UAEPAXI@Z PROC			; ioUDPClientSecurity::`scalar deleting destructor', COMDAT
; _this$ = ecx
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi
  00004	8b f1		 mov	 esi, ecx
  00006	e8 00 00 00 00	 call	 ??1ioUDPClientSecurity@@UAE@XZ ; ioUDPClientSecurity::~ioUDPClientSecurity
  0000b	f6 45 08 01	 test	 BYTE PTR ___flags$[ebp], 1
  0000f	74 07		 je	 SHORT $LN1@scalar@2
  00011	56		 push	 esi
  00012	e8 00 00 00 00	 call	 ??3@YAXPAX@Z		; operator delete
  00017	59		 pop	 ecx
$LN1@scalar@2:
  00018	8b c6		 mov	 eax, esi
  0001a	5e		 pop	 esi
  0001b	5d		 pop	 ebp
  0001c	c2 04 00	 ret	 4
??_GioUDPClientSecurity@@UAEPAXI@Z ENDP			; ioUDPClientSecurity::`scalar deleting destructor'
_TEXT	ENDS
END
